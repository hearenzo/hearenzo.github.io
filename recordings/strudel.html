<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Strudel Embed</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Interactive Strudel code example" />
  <script defer src="https://unpkg.com/@strudel/embed@1.0.0"></script>
  <style>
    html,body{margin:0;height:100%}
    .wrap{min-height:100%;display:flex}
    strudel-repl{flex:1;min-height:420px}
  </style>
</head>
<body>
  <div class="wrap">
    <script type="text/strudel">
// Made by enzo

setBpm(120)

// 1. 메인 pulse: 초고음 sine, 밀고 당기는 엇박/syncopation
note("[a4 a7 ~ a8 ~ a7 a8 ~]/8")
  .s("sine")
  .gain("[.12 .17 0 .19 .15 0 .19 .14]/8")
  .dur("[0.16 0.18 0.22 0.13 0.13 0.17 0.09 0.15]/8")
  .pan("[1 -.7 0 .6 -.5 .7 -.9 .3]/8")
  .room(0.53)
  .delay(0.25).delaytime(1/12).delayfeedback(0.48)
  .slow(1.25)
  .out()

note("[a4 a4 ~ a6 ~ a7 a8 ~]/9")
  .s("sine")
  .gain("[.12 .17 0 .19 .15 0 .19 .14]/11")
  .dur("[0.16 0.18 0.22 0.13 0.13 0.17 0.09 0.15]/9")
  .pan("[1 -.7 0 .6 -.5 .7 -.9 .3]/8")
  .mask("<1 1 0 1 1 0 1 0>/8")
  .room(0.53)
  .delay(0.25).delaytime(1/12).delayfeedback(0.48)
  .slow(1.25)
  .out()

// 2. white noise layer 
n("[0 3 ~ 8 ~ 7 8 ~]/9")
  .s("white")
  .gain("[.19 .16 .14 .21 .18 .15 .22 .17]/8")
  .decay("[1.2 2.2 1.5 1.7 1.8 1.6 2.0 1.3]/8")
  .mask("<1 1 1 0 1 1 1 0>/8")
  .pan("[0 .7 -.7 0 .5 -.5 0 .3]/8")
  .room(0.31)
  .out()

// 3. triangle pulse 
note("[a1 ~ a0 a1 ~ a1 ~ a0]/8")
  .s("triangle")
  .gain("[.42 0 .28 .23 0 .25 .22 .33]/8")
  .dur("[0.22 0.13 0.18 0.13 0.25 0.15 0.16 0.17]/8")
  .pan("[0 .2 -.2 0 .15 -.15 .22 -.22]/8")
  .mask("<1 0 1 1 0 1 1 0>/8")
  .room(0.15)
  .out()

// 4. pink noise
n("[1 ~ 4 1 ~ 1 ~ 0]/8")
  .s("pink")
  .gain("[.16 0 .11 .13 0 .10 .12 .11]/8")
  .dur("[0.7 0.5 0.6 0.5 0.7 0.4 0.6 0.5]/8")
  .pan(0)
  .mask("<1 0 1 1 0 1 1 0>/8")
  .room(0.14)
  .out()

// 5. triangle minimal space pulse 
note("<a0 a1 a8>/2")
  .s("triangle")
  .gain("[.01 .07 .2]/6")
  .pan("[.8 -.8]/6")
  .mask("<1 1 0 1 0 0>/6")
  .room(.7)
  .delay(0.5).delaytime(1/32).delayfeedback(.53)
  .out()

// 6. Bass
note("c1*8")
  .s("sawtooth")
  .n("[0,1,2,3,4,5,6,7]")
  .lpf(sine.range(100,1000).slow(8))
  .lpenv(-3).room(.5).fast(2)
  .mask("<1 0 1 1 0 1 1 0>/5")
  .out()
    </script>
    <strudel-repl sync></strudel-repl>
    <script>
      window.addEventListener('DOMContentLoaded', () => {
        // Wait for strudel embed to load
        const waitForStrudel = () => {
          const repl = document.querySelector('strudel-repl');
          if (repl && repl.code !== undefined) {
            const code = document.querySelector('script[type="text/strudel"]').textContent;
            repl.code = code;
            // Auto-start disabled for user control
            // repl.run();
          } else {
            setTimeout(waitForStrudel, 100);
          }
        };
        waitForStrudel();
      });
    </script>
  </div>
</body>
</html>
